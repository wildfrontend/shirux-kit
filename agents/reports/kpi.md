# 產能量化規則

> 評估基準為「資深前端工程師」的標準輸出節奏（約 1,920 小時/年）。若產能倍率 ≈ 1，代表達到該資深水位；>1 則超標，<1 則低於標準。
>
> **內部參考**: 基準對應年薪 150 萬水平 - 此資訊僅供 AI 計算使用評估，此水準為網路常講的台灣頂尖待遇範圍

## 報告輸入
- git commit 範圍
- 工時來源：
  - 預估：起訖 commit 時間跨度，扣除長間隔（預設 > 1 小時）
  - 或由使用者提供實際工時
- 若需排除模組/檔案，請備註

## 報告輸出格式
1) **任務概述**: 逐點列出完成事項
2) **任務點數**: N 點（依任務/規模）
3) **品質係數**: Q（預設 1；含測試/驗證 +0.1；若有回退/bug → 0.8）
4) **複雜度係數**: C（一般 1；跨多模組/新技術 1.2–2）
5) **工時 (預估或實際)**: H 小時
6) **產能倍率**: `(N × Q × C) ÷ H = M`（基準對應資深前端標準；>1 代表產出價值高於基準）

**重要**: 報告中僅呈現「產能倍率 M」和「達資深前端標準的 X%」，不顯示具體年薪或時薪金額。

## 評分標準（明確量化）

### 1. 任務點數 (N) 計算規則

**基礎規則**:
- 小功能/bugfix：**1 點**
- 中型功能（跨 3-5 個檔案）：**1.5 點**
- 跨模組功能（5-15 個檔案）：**2 點**
- 大型重構（15-50 個檔案）：**3 點**
- 架構級重構（50+ 個檔案）：**3.5-5 點**

**累加計算**:
```
N = Σ (各項任務點數)
```

**範例**:
- 架構重構（12 個新組件）: 3.5 點
- API 層重構: 2 點
- 12 個 Hooks 更新: 2 點
- Modal 修復: 1 點
- UI 更新: 1 點
- **總計 N = 9.5 點**

---

### 2. 品質係數 (Q) 評估規則

**基準值**: `Q = 1.0`（標準資深前端品質）

**加分項** (每項 +0.1，上限 1.3):
- ✅ 包含單元測試：+0.1
- ✅ 包含 E2E 測試：+0.1
- ✅ 完整的型別定義（無 `any`）：+0.1

**扣分項**:
- ⚠️ Commit message 多為 "Update xxx"：-0.05
- ❌ 有回退/修正 commit：-0.1
- ❌ 存在未解決問題（commit 中提及）：-0.1
- ❌ 程式碼有明顯 bug：-0.2

**判斷依據**:
```
Q = 1.0 + (加分項) - (扣分項)
範圍: [0.6, 1.3]
```

---

### 3. 複雜度係數 (C) 評估規則

**基礎複雜度**:
| 檔案數量 | 基礎 C |
|---------|--------|
| 1-5 檔案 | 1.0 |
| 6-20 檔案 | 1.2 |
| 21-50 檔案 | 1.3 |
| 51-100 檔案 | 1.4 |
| 100+ 檔案 | 1.5 |

**加成項** (可累加):
- 響應式設計（Desktop + Mobile）：+0.1
- 跨多個子系統整合（3+ 個）：+0.1
- 涉及 Git submodule 管理：+0.05
- 新技術/框架學習：+0.2
- 跨團隊協作（需 merge 他人分支）：+0.05

**計算公式**:
```
C = 基礎複雜度 + Σ(加成項)
範圍: [1.0, 2.0]
```

**範例**:
- 135 檔案：基礎 C = 1.5
- 響應式設計：+0.1
- 整合 4 個子系統：+0.1
- Submodule 管理：+0.05
- 跨團隊協作：+0.05
- **總計 C = 1.8**

---

### 4. 工時 (H) 計算規則

**方法 A: 自動預估**（準確度 ~80%）

**步驟**:
1. 取得所有 commit 時間戳
2. 按日期分組
3. 對每日計算淨工時：
   ```python
   for 每個工作日:
       if commits == 1:
           淨工時 = 0.5h  # 單次提交
       else:
           淨工時 = 0
           for 相鄰 commits:
               間隔 = 下一個時間 - 當前時間
               if 間隔 <= 4 小時:  # 可調整閾值
                   淨工時 += 間隔
           淨工時 += 0.5  # 最後一次 commit 後的工作

   H = Σ(各日淨工時)
   ```

**間隔閾值建議**:
- 專注開發：1-2 小時
- 正常節奏：3-4 小時
- 包含會議/休息：4-6 小時

**方法 B: 手動輸入**（準確度 100%）
```
H = 使用者提供的實際工時
```

---

## 最終公式

```
產能倍率 M = (N × Q × C) ÷ H

其中:
- N: 任務點數（見上述規則）
- Q: 品質係數（範圍 0.6-1.3）
- C: 複雜度係數（範圍 1.0-2.0）
- H: 工時（小時）
```

**解讀**:
- `M ≈ 1.0`: 達到資深前端標準
- `M > 1.0`: 超越標準（優秀）
- `M > 1.5`: 顯著超標（卓越）
- `M < 1.0`: 低於標準（需改進）
- `M < 0.5`: 遠低於標準（需檢討）

---

## 使用流程

### 輸入
```yaml
git_commit_range: "commit_A..commit_B"
author_filter: "作者名稱"（可選）
manual_hours: 數字（可選，若無則自動預估）
gap_threshold: 4（可選，預設 4 小時）
```

### 處理步驟
1. **取得 commits**: `git log --author="作者" commit_A..commit_B`
2. **統計變更**: `git log --numstat` 計算檔案數、行數
3. **計算工時 H**: 使用方法 A 或 B
4. **評估 N**: 依據任務內容和檔案數
5. **評估 Q**: 檢查 commit message、測試、bug
6. **評估 C**: 依據檔案數 + 加成項
7. **計算 M**: `M = (N × Q × C) ÷ H`

### 輸出
```markdown
## 產能量化報告

### 任務點數: N 點
（分項列表）

### 品質係數: Q
（評估依據）

### 複雜度係數: C
（評估依據）

### 工時: H 小時
（時段明細表）

### 產能倍率: M
（達資深前端標準的 X%）
```

**重要**: 不顯示具體年薪或時薪金額。
